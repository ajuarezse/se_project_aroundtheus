!function(){"use strict";class e{constructor(e,t,s,r,i){let{name:n,link:o,_id:l,isLiked:a,userId:d}=e;this._name=n,this._link=o,this._id=l,this._isLiked=a,this._userId=d,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=r,this._handleLikeClick=i}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleLikeClick(this._id,this)})),this._cardElement.querySelector(".card__button-trash").addEventListener("click",(()=>{this._handleDeleteClick(this._id,this)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}updateLikes(e){const t=this._cardElement.querySelector(".card__like-button");this._isLiked?t.classList.add("card__like-button_active"):t.classList.remove("card__like-button_active"),this._isLiked=!this._isLiked}removeCard(){this._cardElement.remove(),this._cardElement=null}getView(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0);const e=this._cardElement.querySelector(".card__image");return this._cardElement.querySelector(".card__title").textContent=this._name,e.src=this._link,e.alt=this._name,this.updateLikes(this._likes),this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputEls=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){this.errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this.errorMessageEl.textContent=e.validationMessage,this.errorMessageEl.classList.add(this._errorClass)}_hideInputError(e){this.errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this.errorMessageEl.textContent="",this.errorMessageEl.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputEls.some((e=>!e.validity.valid))}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this.disableButton()})),this._setEventListeners(),this.toggleButtonState()}resetValidation(){this.toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)})),this.toggleButtonState()}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.querySelector(".modal__close").addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}const r={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__span_opened"},i=(document.querySelectorAll(r.formSelector),document.querySelector("#profile-edit-button")),n=document.querySelector("#profile-edit-modal"),o=(n.querySelector(".modal__close"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input")),l=document.querySelector("#profile-description-input"),a=document.querySelector(".profile__add-button"),d=document.querySelector("#add-card-modal"),c=(document.querySelector("#add-card-close-button"),n.querySelector(".modal__form")),u=(document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,d.querySelector(".modal__form"));document.querySelector("#modal-preview"),document.querySelector(".modal__image"),document.querySelector(".modal__preview-title"),document.querySelector("#preview-image-close"),u.querySelector(".modal__input_type_title"),u.querySelector(".modal__input_type_url");class h extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputElements=Array.from(this._popupForm.querySelectorAll(".modal__input")),this._submitButton=this._popupElement.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){const e={};return this._inputElements.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}close(){super.close(),this._popupForm.reset()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}}const _=new class{constructor(e){let{titleSelector:t,descriptionSelector:s,avatarSelector:r}=e;this._profileTitle=document.querySelector(t),this._profileDescription=document.querySelector(s),this._avatar=document.querySelector(r)}getUserInfo(){return{title:this._profileTitle.textContent,description:this._profileDescription.textContent}}setUserInfo(e){let{title:t,description:s}=e;this._profileTitle.textContent=t,this._profileDescription.textContent=s}setUserAvatar(e){let{avatar:t}=e;this._avatar.src=t}}({titleSelector:".profile__title",descriptionSelector:".profile__description",avatarSelector:".profile__image"}),m=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleResponse)}updateProfileInfo(e){let{name:t,description:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._handleResponse)}addCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._handleResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._handleResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}updateProfileAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}getAppData(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"b67d986e-405b-4d76-86b9-0a516353ed7d","Content-Type":"application/json"}}),p=new h("#edit-avatar-modal",(function(e){p.renderLoading(!0),m.updateProfileAvatar(e.url).then((e=>{_.setUserAvatar(e),p.close()})).catch(console.error).finally((()=>{p.renderLoading(!1)}))}));p.setEventListeners();const E=document.forms["avatar-form"],v=document.querySelector(".profile__avatar-button"),S=new t(r,E);let f;S.enableValidation(),v.addEventListener("click",(()=>{p.open(),S.resetValidation()})),m.getAppData().then((e=>{let[t,s]=e;_.setUserInfo({title:t.name,description:t.about}),_.setUserAvatar({avatar:t.avatar}),f=t._id,C.setItems(s),C.renderItems()})).catch(console.error);const b=new class extends s{constructor(e){super({popupSelector:e}),this._imageElement=this._popupElement.querySelector(".modal__image"),this._imageTitle=this._popupElement.querySelector(".modal__preview-title")}open(e){this._imageElement.src=e.link,this._imageElement.alt=e.name,this._imageTitle.textContent=e.name,super.open()}}("#modal-preview");b.setEventListeners();const y=new h("#profile-edit-modal",(function(e){y.renderLoading(!0),m.updateProfileInfo({name:e.title,description:e.description}).then((e=>{_.setUserInfo({title:e.name,description:e.about}),y.close()})).catch(console.error).finally((()=>{y.renderLoading(!1)}))}));y.setEventListeners();const L=new class extends s{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._submitButton=this._popupElement.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteConfirm()}))}handleDeleteConfirm(e){this._handleDeleteConfirm=e}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}}({popupSelector:"#delete-card-modal"});L.setEventListeners(),i.addEventListener("click",(()=>{const e=_.getUserInfo();o.value=e.title,l.value=e.description,y.open(),q.resetValidation()}));const g=new h("#add-card-modal",(function(e){g.renderLoading(!0);const{title:t,url:s}=e;m.addCard({name:t,link:s}).then((e=>{k({name:e.name,link:e.link,_id:e._id,likes:e.likes,userId:f}),g.close()})).catch(console.error).finally((()=>{g.renderLoading(!1)}))}));function k(t){const s=function(t){return new e(t,"#card-template",(e=>{b.open(e)}),B,w).getView()}(t);C.addItem(s)}g.setEventListeners(),a.addEventListener("click",(()=>{g.open()}));const C=new class{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}setItems(e){this._items=e}}({items:[],renderer:k},".cards__list"),q=new t(r,c),I=new t(r,d);function B(e,t){L.open(),L.handleDeleteConfirm((()=>{L.renderLoading(!0),m.deleteCard(e).then((()=>{t.removeCard(),L.close()})).catch(console.error).finally((()=>{L.renderLoading(!1)}))}))}function w(e,t){t._isLiked?m.likeCard(e).then((e=>{t.updateLikes(e.likes)})).catch(console.error):m.unlikeCard(e).then((e=>{t.updateLikes(e.likes)})).catch(console.error)}q.enableValidation(),I.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVlGLEVBQ2pCak0sS0FBS29NLFdBQWEvSyxTQUFTVixjQUFjb0wsRUFDM0MsQ0FFQXRCLFdBQUFBLEdBQ0V6SyxLQUFLa00sT0FBT25JLFNBQVNzSSxJQUNuQnJNLEtBQUttTSxVQUFVRSxFQUFLLEdBRXhCLENBRUFQLE9BQUFBLENBQVFRLEdBQ050TSxLQUFLb00sV0FBV0csUUFBUUQsRUFDMUIsQ0FFQTlCLFFBQUFBLENBQVN3QixHQUNQaE0sS0FBS2tNLE9BQVNGLENBQ2hCLEdMOEpBLENBQ0VBLE1BQU8sR0FDUEMsU0FBVVIsR0FFWixnQkFHSUosRUFBMkIsSUFBSXhKLEVBQ25DdUksRUFDQUEsR0FFSW9DLEVBQXVCLElBQUkzSyxFQUMvQnVJLEVBQ0FBLEdBTUYsU0FBU3VCLEVBQWlCekMsRUFBUXdDLEdBQ2hDWCxFQUFnQnhHLE9BQ2hCd0csRUFBZ0JHLHFCQUFvQixLQUNsQ0gsRUFBZ0J6RSxlQUFjLEdBQzlCcUIsRUFDR3NCLFdBQVdDLEdBQ1hWLE1BQUssS0FDSmtELEVBQVl2SyxhQUNaNEosRUFBZ0J0RyxPQUFPLElBRXhCbUYsTUFBTUMsUUFBUUMsT0FDZEMsU0FBUSxLQUNQZ0IsRUFBZ0J6RSxlQUFjLEVBQU0sR0FDcEMsR0FFUixDQUVBLFNBQVNzRixFQUFlMUMsRUFBUXdDLEdBQ3pCQSxFQUFZdkwsU0FRZndILEVBQ0d3QixTQUFTRCxHQUNUVixNQUFNaUUsSUFDTGYsRUFBWTdLLFlBQVk0TCxFQUFnQjNMLE1BQU0sSUFFL0M4SSxNQUFNQyxRQUFRQyxPQVpqQm5DLEVBQ0d5QixXQUFXRixHQUNYVixNQUFNaUUsSUFDTGYsRUFBWTdLLFlBQVk0TCxFQUFnQjNMLE1BQU0sSUFFL0M4SSxNQUFNQyxRQUFRQyxNQVNyQixDQXBDQXVCLEVBQXlCcEgsbUJBQ3pCdUksRUFBcUJ2SSxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cERlbGV0ZUNhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHsgbmFtZSwgbGluaywgX2lkLCBpc0xpa2VkLCB1c2VySWQgfSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VDbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgIHRoaXMuX2lkID0gX2lkO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcy5faWQsIHRoaXMpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19idXR0b24tdHJhc2hcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcy5faWQsIHRoaXMpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVMaWtlcyhsaWtlcykge1xyXG4gICAgY29uc3QgbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xyXG4gICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gIXRoaXMuX2lzTGlrZWQ7XHJcbiAgfVxyXG5cclxuICByZW1vdmVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgY29uc3QgY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY29uc3QgY2FyZFRpdGxlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgY2FyZEltYWdlRWwuc3JjID0gdGhpcy5fbGluaztcclxuICAgIGNhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgdGhpcy51cGRhdGVMaWtlcyh0aGlzLl9saWtlcyk7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWwpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbDtcclxuICAgIHRoaXMuX2lucHV0RWxzID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIHRoaXMuZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLmVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIHRoaXMuZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xyXG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RWxzLnNvbWUoKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvL3RoaXMuX2lucHV0RWxzID0gQXJyYXkuZnJvbShcclxuICAgIC8vdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICAvLyk7XHJcbiAgICAvL3RoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZSkgPT4ge1xyXG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIGNvbnN0IGNsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG4gICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCIvL2FycmF5XHJcbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmREYXRhID0ge1xyXG4gIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG59O1xyXG5cclxuLy9lbGVtZW50c1xyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19zcGFuX29wZW5lZFwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Q2xvc2VCdXR0b24gPVxyXG4gIHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkTmV3TW9kYWxDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjYWRkLWNhcmQtY2xvc2UtYnV0dG9uXCJcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9XHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbmV4cG9ydCBjb25zdCBhZGROZXdDYXJkRm9ybUVsZW1lbnQgPVxyXG4gIGFkZE5ld01vZGFsQ2FyZC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1wcmV2aWV3XCIpO1xyXG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX3ByZXZpZXctdGl0bGVcIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlTW9kYWxDbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJldmlldy1pbWFnZS1jbG9zZVwiXHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgY2FyZFRpdGxlSW5wdXQgPSBhZGROZXdDYXJkRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9faW5wdXRfdHlwZV90aXRsZVwiXHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgY2FyZFVybElucHV0ID0gYWRkTmV3Q2FyZEZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfdXJsXCJcclxuKTtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgKiBhcyBjb25zdGFudHMgZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IFBvcHVwRGVsZXRlQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cERlbGV0ZUNhcmQuanNcIjtcclxuXHJcbi8qIEZ1bmN0aW9ucyAqL1xyXG5mdW5jdGlvbiBoYW5kbGVFc2MoZXZ0KSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XHJcbiAgICBtb2RhbC5jbG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuLyogRXZlbnQgSGFuZGxlcnMgKi9cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIHRpdGxlU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgZGVzY3JpcHRpb25TZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcclxufSk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJiNjdkOTg2ZS00MDViLTRkNzYtODZiOS0wYTUxNjM1M2VkN2RcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjZWRpdC1hdmF0YXItbW9kYWxcIixcclxuICBoYW5kbGVBdmF0YXJGb3JtU3VibWl0XHJcbik7XHJcbmVkaXRBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgcHJvZmlsZUF2YXRhckZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImF2YXRhci1mb3JtXCJdO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnV0dG9uXCIpO1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uc3RhbnRzLmNvbmZpZyxcclxuICBwcm9maWxlQXZhdGFyRm9ybVxyXG4pO1xyXG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmxldCB1c2VySWQ7XHJcblxyXG5wcm9maWxlQXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcclxuICBhdmF0YXJGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmFwaVxyXG4gIC5nZXRBcHBEYXRhKClcclxuICAudGhlbigoW3VzZXJEYXRhLCBpbml0aWFsQ2FyZHNdKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIHRpdGxlOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogdXNlckRhdGEuYWJvdXQsXHJcbiAgICB9KTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoeyBhdmF0YXI6IHVzZXJEYXRhLmF2YXRhciB9KTtcclxuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcclxuXHJcbiAgICBzZWN0aW9uLnNldEl0ZW1zKGluaXRpYWxDYXJkcyk7XHJcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlU3VibWl0KHVzZXJEYXRhKSB7XHJcbiAgcHJvZmlsZVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlUHJvZmlsZUluZm8oe1xyXG4gICAgICBuYW1lOiB1c2VyRGF0YS50aXRsZSxcclxuICAgICAgZGVzY3JpcHRpb246IHVzZXJEYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgfSlcclxuICAgIC50aGVuKCh1cGRhdGVkVXNlckRhdGEpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICAgIHRpdGxlOiB1cGRhdGVkVXNlckRhdGEubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlZFVzZXJEYXRhLmFib3V0LFxyXG4gICAgICB9KTtcclxuICAgICAgcHJvZmlsZVBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdChjYXJkRGF0YSkge1xyXG4gIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGNvbnN0IHsgdGl0bGUsIHVybCB9ID0gY2FyZERhdGE7XHJcbiAgYXBpXHJcbiAgICAuYWRkQ2FyZCh7IG5hbWU6IHRpdGxlLCBsaW5rOiB1cmwgfSlcclxuICAgIC50aGVuKChuZXdDYXJkRGF0YSkgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKHtcclxuICAgICAgICBuYW1lOiBuZXdDYXJkRGF0YS5uYW1lLFxyXG4gICAgICAgIGxpbms6IG5ld0NhcmREYXRhLmxpbmssXHJcbiAgICAgICAgX2lkOiBuZXdDYXJkRGF0YS5faWQsXHJcbiAgICAgICAgbGlrZXM6IG5ld0NhcmREYXRhLmxpa2VzLFxyXG4gICAgICAgIHVzZXJJZDogdXNlcklkLFxyXG4gICAgICB9KTtcclxuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KGRhdGEpIHtcclxuICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC51cGRhdGVQcm9maWxlQXZhdGFyKGRhdGEudXJsKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHJlcyk7XHJcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuY29uc3QgcHJldmlld0ltYWdlTW9kYWwgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjbW9kYWwtcHJldmlld1wiKTtcclxucHJldmlld0ltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGhhbmRsZVByb2ZpbGVTdWJtaXRcclxuKTtcclxucHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBEZWxldGVDYXJkKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNkZWxldGUtY2FyZC1tb2RhbFwiLFxyXG59KTtcclxuZGVsZXRlQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdGFudHMucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCBjdXJyZW50VXNlciA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgY29uc3RhbnRzLnByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gY3VycmVudFVzZXIudGl0bGU7XHJcbiAgY29uc3RhbnRzLnByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gY3VycmVudFVzZXIuZGVzY3JpcHRpb247XHJcblxyXG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XHJcbiAgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI2FkZC1jYXJkLW1vZGFsXCIsXHJcbiAgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXRcclxuKTtcclxuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdGFudHMuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmREYXRhLFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgKGRhdGEpID0+IHtcclxuICAgICAgcHJldmlld0ltYWdlTW9kYWwub3BlbihkYXRhKTtcclxuICAgIH0sXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkLFxyXG4gICAgaGFuZGxlTGlrZUNhcmRcclxuICApO1xyXG4gIHJldHVybiBuZXdDYXJkLmdldFZpZXcoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxufVxyXG5cclxuY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBbXSxcclxuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxyXG4gIH0sXHJcbiAgXCIuY2FyZHNfX2xpc3RcIlxyXG4pO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uc3RhbnRzLmNvbmZpZyxcclxuICBjb25zdGFudHMucHJvZmlsZUVkaXRGb3JtXHJcbik7XHJcbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uc3RhbnRzLmNvbmZpZyxcclxuICBjb25zdGFudHMuYWRkTmV3TW9kYWxDYXJkXHJcbik7XHJcblxyXG5lZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRJZCwgY2FyZEVsZW1lbnQpIHtcclxuICBkZWxldGVDYXJkUG9wdXAub3BlbigpO1xyXG4gIGRlbGV0ZUNhcmRQb3B1cC5oYW5kbGVEZWxldGVDb25maXJtKCgpID0+IHtcclxuICAgIGRlbGV0ZUNhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmRFbGVtZW50LnJlbW92ZUNhcmQoKTtcclxuICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBkZWxldGVDYXJkUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2FyZChjYXJkSWQsIGNhcmRFbGVtZW50KSB7XHJcbiAgaWYgKCFjYXJkRWxlbWVudC5faXNMaWtlZCkge1xyXG4gICAgYXBpXHJcbiAgICAgIC51bmxpa2VDYXJkKGNhcmRJZClcclxuICAgICAgLnRoZW4oKHVwZGF0ZWRDYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgIGNhcmRFbGVtZW50LnVwZGF0ZUxpa2VzKHVwZGF0ZWRDYXJkRGF0YS5saWtlcyk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYXBpXHJcbiAgICAgIC5saWtlQ2FyZChjYXJkSWQpXHJcbiAgICAgIC50aGVuKCh1cGRhdGVkQ2FyZERhdGEpID0+IHtcclxuICAgICAgICBjYXJkRWxlbWVudC51cGRhdGVMaWtlcyh1cGRhdGVkQ2FyZERhdGEubGlrZXMpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgfVxyXG59XHJcbiIsImNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IHRpdGxlU2VsZWN0b3IsIGRlc2NyaXB0aW9uU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGl0bGVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRpdGxlOiB0aGlzLl9wcm9maWxlVGl0bGUudGV4dENvbnRlbnQsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyB0aXRsZSwgZGVzY3JpcHRpb24gfSkge1xyXG4gICAgdGhpcy5fcHJvZmlsZVRpdGxlLnRleHRDb250ZW50ID0gdGl0bGU7XHJcbiAgICB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVJlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3IgJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy9HRVQgaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvdXNlcnMvbWVcclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgLy9HRVQgaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvY2FyZHNcclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIC8vUEFUQ0ggaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvdXNlcnMvbWVcclxuICB1cGRhdGVQcm9maWxlSW5mbyh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGFib3V0OiBkZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIC8vUE9TVCBodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS9jYXJkc1xyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIC8vREVMRVRFIGh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzL2NhcmRJZFxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIC8vUFVUIGh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzL2NhcmRJZC9saWtlc1xyXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICAvL0RFTEVURSBodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS9jYXJkcy9jYXJkSWQvbGlrZXNcclxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICAvL1BBVENIIGh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL3VzZXJzL21lL2F2YXRhclxyXG4gIHVwZGF0ZVByb2ZpbGVBdmF0YXIodXJsKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogdXJsLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBwRGF0YSgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5faW1hZ2VUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9fcHJldmlldy10aXRsZVwiXHJcbiAgICApOyAvLyBDb3JyZWN0ZWQgY2xhc3MgbmFtZVxyXG4gIH1cclxuXHJcbiAgb3BlbihkYXRhKSB7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IGRhdGEubmFtZTsgLy8gU2ltcGxpZmllZCBhbHQgdGV4dFxyXG4gICAgdGhpcy5faW1hZ2VUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cERlbGV0ZUNhcmQgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ29uZmlybSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVEZWxldGVDb25maXJtKGhhbmRsZURlbGV0ZSkge1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ29uZmlybSA9IGhhbmRsZURlbGV0ZTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcblxyXG4gIHNldEl0ZW1zKGl0ZW1zKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjtcclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJuYW1lIiwibGluayIsIl9pZCIsImlzTGlrZWQiLCJ1c2VySWQiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9pc0xpa2VkIiwiX3VzZXJJZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsInVwZGF0ZUxpa2VzIiwibGlrZXMiLCJsaWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwicmVtb3ZlQ2FyZCIsImdldFZpZXciLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkSW1hZ2VFbCIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiX2xpa2VzIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJfaW5wdXRFbHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJzb21lIiwiX2VuYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiZGlzYWJsZUJ1dHRvbiIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImUiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJjb25maWciLCJmb3JtU2VsZWN0b3IiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0TW9kYWwiLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwiYWRkTmV3Q2FyZEJ1dHRvbiIsImFkZE5ld01vZGFsQ2FyZCIsInByb2ZpbGVFZGl0Rm9ybSIsImFkZE5ld0NhcmRGb3JtRWxlbWVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dEVsZW1lbnRzIiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJyZXNldCIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsInVzZXJJbmZvIiwidGl0bGVTZWxlY3RvciIsImRlc2NyaXB0aW9uU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9wcm9maWxlVGl0bGUiLCJfcHJvZmlsZURlc2NyaXB0aW9uIiwiX2F2YXRhciIsImdldFVzZXJJbmZvIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJzZXRVc2VyQXZhdGFyIiwiX3JlZjMiLCJhdmF0YXIiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0SW5pdGlhbENhcmRzIiwidXBkYXRlUHJvZmlsZUluZm8iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiYWRkQ2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJ1cGRhdGVQcm9maWxlQXZhdGFyIiwidXJsIiwiZ2V0QXBwRGF0YSIsImFsbCIsImF1dGhvcml6YXRpb24iLCJlZGl0QXZhdGFyUG9wdXAiLCJkYXRhIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJmaW5hbGx5IiwicHJvZmlsZUF2YXRhckZvcm0iLCJmb3JtcyIsInByb2ZpbGVBdmF0YXJCdXR0b24iLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwiY29uc3RhbnRzIiwidXNlckRhdGEiLCJpbml0aWFsQ2FyZHMiLCJzZWN0aW9uIiwic2V0SXRlbXMiLCJyZW5kZXJJdGVtcyIsInByZXZpZXdJbWFnZU1vZGFsIiwiX2ltYWdlRWxlbWVudCIsIl9pbWFnZVRpdGxlIiwicHJvZmlsZVBvcHVwIiwidXBkYXRlZFVzZXJEYXRhIiwiZGVsZXRlQ2FyZFBvcHVwIiwiZXZ0IiwiX2hhbmRsZURlbGV0ZUNvbmZpcm0iLCJoYW5kbGVEZWxldGVDb25maXJtIiwiaGFuZGxlRGVsZXRlIiwiY3VycmVudFVzZXIiLCJlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkUG9wdXAiLCJjYXJkRGF0YSIsIm5ld0NhcmREYXRhIiwicmVuZGVyQ2FyZCIsImNhcmRFbGVtZW50IiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2VDYXJkIiwiY3JlYXRlQ2FyZCIsImFkZEl0ZW0iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJ1cGRhdGVkQ2FyZERhdGEiXSwic291cmNlUm9vdCI6IiJ9